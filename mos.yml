author: Richard Lyon <richardlyon@fastmail.com>
description: Send HDC1080 readings by MQTT
version: 1.0

name: KINGSWOOD_ENVIRONMENT_SENSOR

# libs_version: ${mos.version}
# modules_version: ${mos.version}
# mongoose_os_version: ${mos.version}

tags:
  - c
  - HDC1080

sources:
  - src

filesystem:
  - fs

config_schema:
  - ["wifi.sta.enable", true]
  - ["wifi.ap.enable", false]
  - ["wifi.sta.ssid", "Kingswood"]
  - ["wifi.sta.pass", "wbtc0rar"]
  - ["mqtt.enable", true]
  - ["mqtt.server", 192.168.1.200:1883]
  - ["mqtt.will_message", "OFFLINE"]
  - ["mqtt.will_topic", "status"] # updated programmatically with topic root
  - ["mqtt.will_retain", true]
  - ["provision.led.pin", 2]
  - ["i2c.enable", true]
  - ["i2c.scl_gpio", "i", 5, { title: "scl" }]
  - ["i2c.sda_gpio", "i", 4, { title: "sda" }]
  - ["json", "o", { title: "JSON data " }]
  - ["json.protocol_version", "s", "1.0", { title: "JSON protocol version" }]
  - ["device.type", "s", "ESP8266", { title: "MCU typye" }]
  - ["device.location", "s", "livingroom", { title: "Sensor MQTT topic root" }]
  - [
      "device.firmware_title",
      "s",
      "Kingswood System Environment Sensor",
      { title: "Device firmware title" },
    ]
  - ["device.firmware_version", "s", "1.5", { title: "Firmware version" }]
  - [
      "device.firmware_filename",
      "s",
      "sensor-environment-livingroom-NODEMCUDEVKIT-mongoose",
      { title: "Firmware filename" },
    ]

  - ["device.os", "s", "Mongoose OS", { title: "Firmware operating system" }]
  - [
      "device.battery.active",
      "b",
      true,
      { title: "True if the device is on battery power" },
    ]
  - [
      "sensor.interval",
      "i",
      3000,
      { title: "Data refresh period (milliseconds" },
    ]
  - [
      "sensor.scd30.refreshIntervalSecs",
      "i",
      3,
      { title: "Data refresh period (milliseconds" },
    ]
  - [
      "sensor.scd30.defaultAmbientPressureMbar",
      "i",
      1023,
      { title: "Data refresh period (milliseconds" },
    ]

libs:
  - origin: https://github.com/mongoose-os-libs/boards
  - origin: https://github.com/mongoose-os-libs/ca-bundle
  - origin: https://github.com/mongoose-os-libs/rpc-service-config
  - origin: https://github.com/mongoose-os-libs/rpc-service-fs
  - origin: https://github.com/mongoose-os-libs/rpc-uart
  - origin: https://github.com/mongoose-os-libs/wifi
  - origin: https://github.com/mongoose-os-libs/mqtt
  - origin: https://github.com/mongoose-os-libs/provision

  - origin: https://github.com/richardjlyon/arduino_closedcube_hdc1080
  - origin: https://github.com/richardjlyon/arduino_sparkfun_scd30

manifest_version: 2017-09-29
